---
title: "stock-and-flow-thinking"
output: html_document
editor_options: 
  chunk_output_type: console
---


```{r}
# Simplest example

sdm = xmile(stop = 50, time_units = "d")
plot(sdm)
out = simulate_Julia(sdm)
plot_stocks(sdm, out$df)
```


For example, rumination is typically conceived of as a positive feedback loop. Negative thoughts lead to other negative thoughts.
habit
belief
arousal

exponential growth, introduce level


This is a classic example of a negative feedback loop.



```{r}
# Caffeine consumption

sdm = xmile(stop = 50, time_units = "d") %>%
  build("perceived_restfulness", "stock", eqn = "3", units = "rest") %>%
  model_units(symb = "rest") %>%
  build("desired_rest", "aux", eqn = "5", units = "rest") %>%
  build("energy_through_caffeine_consumption", "flow",
        # bug: setting unit of flow
        eqn = "(desired_rest - perceived_restfulness) / u(\"d\")",
        to = "perceived_restfulness", units = "rest/d") %>%
  build("sleep", "aux", eqn = "8", units = "hr/d") %>%
  build("restfulness_of_sleep", "aux", eqn = "2", units = "rest/hr") %>%
  build("sleep_restoring_rest", "flow", eqn = "sleep * restfulness_of_sleep", to = "perceived_restfulness", units = "rest/d") %>%
  build("weariness", "flow", eqn = "3", from = "perceived_restfulness", units = "rest/d")

plot(sdm)
out = simulate_Julia(sdm)
plot_stocks(sdm, out$df)
```


```{r}
library(profvis)

profvis({
  sdm = xmile(stop = 50, time_units = "d") %>%
  build("perceived_restfulness", "stock", eqn = "3", units = "rest") %>%
  model_units(symb = "rest") %>%
  build("desired_rest", "aux", eqn = "5", units = "rest") %>%
  build("energy_through_caffeine_consumption", "flow",
        # bug: setting unit of flow
        eqn = "(perceived_restfulness - desired_rest) / u(\"d\")",
        to = "perceived_restfulness", units = "rest/d") %>%
  build("sleep", "aux", eqn = "8", units = "hr/d") %>%
  build("restfulness_of_sleep", "aux", eqn = "2", units = "rest/hr") %>%
  build("sleep_restoring_rest", "flow", eqn = "sleep * restfulness_of_sleep", to = "perceived_restfulness", units = "rest/d") %>%
  build("weariness", "flow", eqn = "3", from = "perceived_restfulness", units = "rest/d")
})

```



```{r}

# self-hatred lack of social contact
```



```{r}

# peer pressure
```



```{r}

# habituation
```


```{r}

# overextending yourself and overwhelm
```

lying and perceived status

restrict and binge

Working Memory Capacity and Task Performance

Reinforcement and Behavior Frequency


